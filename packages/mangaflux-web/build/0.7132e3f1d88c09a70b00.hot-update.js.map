{"version":3,"file":"0.7132e3f1d88c09a70b00.hot-update.js","sources":["webpack:///src/server/index.js"],"sourcesContent":["import App from '../common/containers/App';\nimport { Provider } from 'react-redux';\nimport React from 'react';\nimport configureStore from '../common/store/configureStore';\nimport express from 'express';\nimport { fetchCounter } from '../common/api/counter';\nimport qs from 'qs';\nimport { renderToString } from 'react-dom/server';\nimport serialize from 'serialize-javascript';\n\nconst assets = require(process.env.RAZZLE_ASSETS_MANIFEST);\n\nconst server = express();\n\nserver\n  .disable('x-powered-by')\n  .use(express.static(process.env.RAZZLE_PUBLIC_DIR))\n  .get('/*', (req, res) => {\n    fetchCounter(apiResult => {\n      // Read the counter from the request, if provided\n      const params = qs.parse(req.query);\n      const counter = parseInt(params.counter, 10) || apiResult || 0;\n\n      // Compile an initial state\n      const preloadedState = { counter };\n\n      // Create a new Redux store instance\n      const store = configureStore(preloadedState);\n\n      // Render the component to a string\n      const markup = renderToString(\n        <Provider store={store}>\n          <App />\n        </Provider>\n      );\n\n      // Grab the initial state from our Redux store\n      const finalState = store.getState();\n\n      res.send(`<!doctype html>\n    <html lang=\"\">\n    <head>\n        <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\" />\n        <meta charSet='utf-8' />\n        <title>Mangaflux</title>\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n        ${assets.client.css\n          ? `<link rel=\"stylesheet\" href=\"${assets.client.css}\">`\n          : ''}\n          ${process.env.NODE_ENV === 'production'\n            ? `<script src=\"${assets.client.js}\" defer></script>`\n            : `<script src=\"${assets.client.js}\" defer crossorigin></script>`}\n    </head>\n    <body>\n        <div id=\"root\">${markup}</div>\n        <script>\n          window.__PRELOADED_STATE__ = ${serialize(finalState)}\n        </script>\n    </body>\n</html>`);\n    });\n  });\n\nexport default server;\n\n\n\n// WEBPACK FOOTER //\n// src/server/index.js"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AACA;AAIA;AACA;AACA;AACA;AAqBA;AACA;AACA;AACA;;;;A","sourceRoot":""}